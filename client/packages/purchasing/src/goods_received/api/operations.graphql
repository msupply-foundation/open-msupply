fragment GoodsReceivedRow on GoodsReceivedNode {
  id
  number
  status
  comment
  createdDatetime
  receivedDatetime
  finalisedDatetime
  purchaseOrderNumber
  supplierReference
  supplier {
    id
    name
  }
}

fragment GoodsReceivedLine on GoodsReceivedLineNode {
  __typename
  id
  batch
  comment
  lineNumber
  goodsReceivedId
  expiryDate
  manufacturerLinkId
  numberOfPacksReceived
  receivedPackSize
  item {
    id
    code
    name
  }
  purchaseOrderLineId
  goodsReceivedId
}

fragment GoodsReceived on GoodsReceivedNode {
  __typename
  id
  comment
  createdBy
  createdDatetime
  number
  finalisedDatetime
  purchaseOrderNumber
  purchaseOrderId
  receivedDatetime
  supplierReference
  status
  supplier {
    id
    name
  }
  lines {
    totalCount
    nodes {
      ...GoodsReceivedLine
    }
  }
}

query goodsReceivedList(
  $first: Int
  $offset: Int
  $key: GoodsReceivedSortFieldInput!
  $desc: Boolean
  $filter: GoodsReceivedFilterInput
  $storeId: String!
) {
  goodsReceivedList(
    page: { first: $first, offset: $offset }
    sort: { key: $key, desc: $desc }
    filter: $filter
    storeId: $storeId
  ) {
    ... on GoodsReceivedConnector {
      __typename
      nodes {
        ...GoodsReceivedRow
      }
      totalCount
    }
  }
}

query goodsReceivedById($id: String!, $storeId: String!) {
  goodsReceived(id: $id, storeId: $storeId) {
    ... on GoodsReceivedNode {
      ...GoodsReceived
    }
    ... on RecordNotFound {
      __typename
      description
    }
  }
}

mutation insertGoodsReceived(
  $input: InsertGoodsReceivedInput!
  $storeId: String!
) {
  insertGoodsReceived(input: $input, storeId: $storeId) {
    ... on IdResponse {
      id
    }
  }
}

mutation updateGoodsReceived(
  $input: UpdateGoodsReceivedInput!
  $storeId: String!
) {
  updateGoodsReceived(input: $input, storeId: $storeId) {
    ... on IdResponse {
      id
    }
  }
}

mutation deleteGoodsReceived($id: String!, $storeId: String!) {
  deleteGoodsReceived(id: $id, storeId: $storeId) {
    ... on DeleteResponse {
      id
    }
  }
}

query goodsReceivedLines(
  $storeId: String!
  $first: Int
  $offset: Int
  $key: GoodsReceivedLineSortFieldInput!
  $desc: Boolean
  $filter: GoodsReceivedLineFilterInput
) {
  goodsReceivedLines(
    storeId: $storeId
    filter: $filter
    page: { first: $first, offset: $offset }
    sort: { key: $key, desc: $desc }
  ) {
    ... on GoodsReceivedLineConnector {
      __typename
      nodes {
        __typename
        ...GoodsReceivedLine
      }
      totalCount
    }
  }
}

query goodsReceivedLine($id: String!, $storeId: String!) {
  goodsReceivedLines(storeId: $storeId, filter: { id: { equalTo: $id } }) {
    ... on GoodsReceivedLineConnector {
      __typename
      nodes {
        __typename
        ...GoodsReceivedLine
      }
      totalCount
    }
  }
}

query goodsReceivedLinesCount(
  $filter: GoodsReceivedLineFilterInput
  $storeId: String!
) {
  goodsReceivedLines(storeId: $storeId, filter: $filter) {
    ... on GoodsReceivedLineConnector {
      __typename
      totalCount
    }
  }
}

mutation insertGoodsReceivedLine(
  $input: InsertGoodsReceivedLineInput!
  $storeId: String!
) {
  insertGoodsReceivedLine(input: $input, storeId: $storeId) {
    ... on IdResponse {
      id
    }
    ... on InsertGoodsReceivedLineError {
      __typename
      error {
        description
        ... on CannotEditGoodsReceived {
          __typename
          description
        }
        ... on ForeignKeyError {
          __typename
          description
          key
        }
        ... on GoodsReceivedLineWithIdExists {
          __typename
          description
        }
      }
    }
  }
}

mutation insertGoodsReceivedLinesFromPurchaseOrder(
  $input: InsertGoodsReceivedLinesFromPurchaseOrderInput!
  $storeId: String!
) {
  insertGoodsReceivedLinesFromPurchaseOrder(input: $input, storeId: $storeId) {
    ... on InsertLinesFromPurchaseOrderResponseNode {
      __typename
      ids
    }
    ... on InsertGoodsReceivedLinesError {
      __typename
      error {
        description
        ... on PurchaseOrderNotFound {
          __typename
          description
        }
        ... on ForeignKeyError {
          __typename
          description
          key
        }
        ... on CannotEditGoodsReceived {
          __typename
          description
        }
      }
    }
  }
}

mutation saveGoodsReceivedLines(
  $input: SaveGoodsReceivedLinesInput!
  $storeId: String!
) {
  saveGoodsReceivedLines(input: $input, storeId: $storeId) {
    ... on IdResponse {
      id
    }
  }
}
