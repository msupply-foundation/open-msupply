{
  "type": "VerticalLayout",
  "elements": [
    {
      "type": "HorizontalLayout",
      "elements": [
        {
          "type": "VerticalLayout",
          "elements": [
            {
              "type": "Group",
              "label": "Patient Information",
              "elements": [
                {
                  "type": "Control",
                  "scope": "#/properties/code",
                  "label": "National Health Id"
                },
                {
                  "type": "IdGenerator",
                  "label": "NUIC",
                  "scope": "#/",
                  "options": {
                    "targetField": "code2",
                    "parts": [
                      {
                        "type": "Field",
                        "field": "lastName",
                        "mutations": [
                          { "firstNChars": 2 },
                          { "toUpperCase": true }
                        ]
                      },
                      {
                        "type": "Field",
                        "field": ["birthPlace", "district"],
                        "mutations": [
                          { "firstNChars": 2 },
                          { "toUpperCase": true }
                        ]
                      },
                      {
                        "type": "Field",
                        "field": "hand",
                        "mutations": [
                          {
                            "mapping": {
                              "LEFT": "L",
                              "RIGHT": "R"
                            }
                          }
                        ]
                      },
                      {
                        "type": "Field",
                        "field": "birthOrder",
                        "mutations": [
                          { "firstNChars": 2 },
                          { "toUpperCase": true }
                        ]
                      },
                      {
                        "type": "Field",
                        "field": "gender",
                        "mutations": [
                          {
                            "mapping": {
                              "MALE": "1",
                              "FEMALE": "2",
                              "TRANSGENDER": "3",
                              "TRANSGENDER_MALE": "3",
                              "TRANSGENDER_FEMALE": "3",
                              "UNKNOWN": "3",
                              "NON_BINARY": "3"
                            }
                          }
                        ]
                      },
                      {
                        "type": "Field",
                        "field": "firstName",
                        "mutations": [
                          { "lastNChars": 2 },
                          { "toUpperCase": true }
                        ]
                      }
                    ]
                  }
                },
                {
                  "type": "Control",
                  "scope": "#/properties/firstName",
                  "label": "First Name"
                },
                {
                  "type": "Control",
                  "scope": "#/properties/lastName",
                  "label": "Last Name"
                },
                {
                  "type": "Control",
                  "scope": "#/properties/gender",
                  "label": "Sex",
                  "options": {
                    "show": [
                      ["MALE", "Male"],
                      ["FEMALE", "Female"],
                      ["TRANSGENDER", "Transgender"]
                    ]
                  }
                },
                {
                  "type": "DateOfBirth",
                  "label": "Date of Birth",
                  "scope": "#"
                },
                {
                  "type": "Control",
                  "label": "DOB Estimated",
                  "scope": "#/properties/dateOfBirthIsEstimated"
                },
                {
                  "type": "Control",
                  "label": "Birth District",
                  "scope": "#/properties/birthPlace/properties/district"
                },
                {
                  "type": "Control",
                  "label": "Birth Province",
                  "scope": "#/properties/birthPlace/properties/region"
                },
                {
                  "type": "Control",
                  "scope": "#/properties/birthOrder"
                },
                {
                  "type": "Control",
                  "scope": "#/properties/hand",
                  "options": {
                    "show": [
                      ["LEFT", "Left"],
                      ["RIGHT", "Right"]
                    ]
                  }
                },
                {
                  "type": "FirstItemArray",
                  "scope": "#/properties/contactDetails",
                  "options": {
                    "detail": {
                      "type": "VerticalLayout",
                      "elements": [
                        {
                          "type": "Control",
                          "scope": "/properties/address1"
                        },
                        {
                          "type": "Control",
                          "scope": "/properties/address2"
                        },
                        {
                          "type": "Control",
                          "scope": "/properties/district"
                        },
                        {
                          "type": "Control",
                          "scope": "/properties/phone"
                        },
                        {
                          "type": "Control",
                          "scope": "/properties/mobile"
                        },
                        {
                          "type": "Control",
                          "scope": "/properties/email"
                        }
                      ]
                    }
                  }
                }
              ]
            }
          ]
        },
        {
          "type": "VerticalLayout",
          "elements": [
            {
              "type": "Group",
              "label": "Demographics",
              "elements": [
                {
                  "type": "Control",
                  "scope": "#/properties/family/properties/maritalStatus",
                  "options": {
                    "show": [
                      ["SINGLE", "Single"],
                      ["MARRIED", "Married"],
                      ["DIVORCED", "Divorced"],
                      ["WIDOWED", "Widowed"],
                      ["SEPARATED", "Separated"],
                      ["REGISTERED_PARTNERSHIP", "Registered Partnership"]
                    ]
                  }
                },
                {
                  "type": "Control",
                  "scope": "#/properties/socioEconomics/properties/education"
                },
                {
                  "type": "Control",
                  "scope": "#/properties/socioEconomics/properties/occupation"
                }
              ]
            },
            {
              "type": "Control",
              "scope": "#/properties/allergies/properties/drugAllergies",
              "itemLabel": "${index}: ${drug}",
              "options": {
                "detail": {
                  "type": "VerticalLayout",
                  "elements": [
                    {
                      "type": "Control",
                      "scope": "/properties/drug"
                    },
                    {
                      "type": "Control",
                      "scope": "/properties/description"
                    }
                  ]
                }
              }
            },
            {
              "type": "Group",
              "label": "Family Information",
              "elements": [
                {
                  "type": "AccordionGroup",
                  "label": "Next of Kin",
                  "elements": [
                    {
                      "type": "Control",
                      "scope": "#/properties/family/properties/nextOfKin/properties/firstName"
                    },
                    {
                      "type": "Control",
                      "scope": "#/properties/family/properties/nextOfKin/properties/lastName"
                    },
                    {
                      "type": "FirstItemArray",
                      "scope": "#/properties/family/properties/nextOfKin/properties/contactDetails",
                      "options": {
                        "detail": {
                          "type": "VerticalLayout",
                          "elements": [
                            {
                              "type": "Control",
                              "scope": "/properties/phone"
                            },
                            {
                              "type": "Control",
                              "scope": "/properties/mobile"
                            },
                            {
                              "type": "Control",
                              "scope": "/properties/email"
                            }
                          ]
                        }
                      }
                    }
                  ]
                }
              ]
            },
            {
              "type": "Group",
              "label": "Death",
              "elements": [
                {
                  "type": "Control",
                  "scope": "#/properties/isDeceased"
                },
                {
                  "type": "Control",
                  "scope": "#/properties/dateOfDeath",
                  "rule": {
                    "effect": "HIDE",
                    "condition": {
                      "scope": "#/properties/isDeceased",
                      "schema": {
                        "const": false
                      }
                    }
                  }
                }
              ]
            }
          ]
        }
      ]
    }
  ]
}
